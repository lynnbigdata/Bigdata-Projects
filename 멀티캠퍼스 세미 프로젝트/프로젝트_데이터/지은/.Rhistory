slsl_lm_plus
summary(slsl_lm_plus)
#dolbomplus
test01 <- lm(dolbomplus ~ fin + schools + hanbumo, data = slsl)
summary(test01)
#dolbomplus
head(slsl)
head(local)
local <- read.table(file.choose(), sep='\t')                  # 자치구별 지역돌봄센터.txt
head(local)
local <- local[5:29,c(2,3,4)]
names(local) <- c("gu","facilities","users")
head(local)
local <- local[order(local$gu),]
local$facilities <- as.numeric(local$facilities)
local$users <- as.numeric(local$users)
class(local$facilities)
head(local)
cbind(slsl$dolbom, local$facilities, slsl$dolbomplus)
slsl_lm_plus
cbind(slsl$dolbom, local$facilities, slsl$dolbomplus)
cbind(slsl$gu,slsl$dolbom, local$facilities, slsl$dolbomplus)
#dolbomplus
head(slsl)
local <- read.table(file.choose(), sep='\t')                  # 자치구별 지역돌봄센터.txt
head(local)
local <- local[5:29,c(2,3,4)]
names(local) <- c("gu","facilities","users")
head(local)
local <- local[order(local$gu),]
head(local)
local$facilities <- as.numeric(local$facilities)
local$users <- as.numeric(local$users)
class(local$facilities)
head(local)
finance <- read.table(file.choose(), sep='\t', header=T)        # 자치구별 재정자립도.txt
finance
finance_gu <- finance[4:28,2:3]
finance_gu <- finance_gu[order(finance_gu$자치구별),]
finance_gu
names(finance_gu) <- c("gu", "fin")
finance_gu$fin
class(finance_gu$fin
)
class(finance_gu$fin)
slsl <- read.table(file.choose(), sep='\t', header=T)       # 서울시 구별 현황_hanbumo.txt
head(slsl)
slsl$dolbomplus <- slsl$dolbom + local$facilities
slsl$dolbomplus <- slsl$dolbom_total + local$facilities
head(slsl)
slsl_lm_plus <- lm(dolbomplus ~ fin+students+bmi , data = slsl)
seoulbmi <- read.table(file.choose(), sep='\t', header=T)
seoulbmi
class(seoulbmi$bmi)
slsl <- cbind(slsl, finance_gu$fin, seoulbmi$bmi)
head(slsl)
colnames(slsl$`finance_gu$fin`)
colnames(slsl$`finance_gu$fin`) <- "fin"
colnames(slsl)
colnames(slsl) <- c("gu","schools","students","dolbom_avg","students_par_per", "hanbumo","base",
"dolbom_total","dolbomplus","fin","bmi"  )
head(slsl)
smoke <- read.table(file.choose(), sep='\t', header=T)                # 현재흡연율_서울시.txt
smoke
smoke$smnumbers <- smoke$응답자수..명. * smoke$조율.... / 100
smoke <- smoke[2:26,c(1,4,8)]
names(smoke) <- c("gu","smoper","sm")
smoke
alcohol <- read.table(file.choose(), sep='\t', header=T)
alcohol
alcohol$alnumbers <- alcohol$응답자수..명. * alcohol$조율.... / 100
alcohol <- alcohol[2:26,c(1,3,7)]
alcohol
names(alcohol) <- c("gu", "alper", "al")
slsl <- cbind(slsl, smoke$smoper, smoke$sm, alcohol$alper, alcohol$al)
head(slsl)
colnames(slsl) <- c("gu","schools","students","dolbom_avg","students_par_per", "hanbumo","base",
"dolbom_total","dolbomplus","fin","bmi","smoper", "sm", "alper", "al"  )
head(slsl)
#regression
slsl_lm_plus.null <- lm(dolbomplus~1, data = slsl)
slsl_lm_plus <- lm(dolbomplus ~ students+hanbumo+base+fin+bmi+smoper+sm+alper+al , data = slsl)
vif(slsl_lm_plus)
class(slsl$students)
slsl$students
slsl <- read.table(file.choose(), sep='\t', header=T)       # slsl.txt
head(slsl)
slsl$dolbomplus <- slsl$dolbom_total + local$facilities
slsl <- cbind(slsl, finance_gu$fin, seoulbmi$bmi)
slsl <- cbind(slsl, smoke$smoper, smoke$sm, alcohol$alper, alcohol$al)
head(slsl)
colnames(slsl) <- c("gu","schools","students","dolbom_avg","students_par_per", "hanbumo","base",
"dolbom_total","dolbomplus","fin","bmi","smoper", "sm", "alper", "al"  )
head(slsl)
class(slsl$students)
slsl_lm_plus <- lm(dolbomplus ~ students+hanbumo+base+fin+bmi+smoper+sm+alper+al , data = slsl)
vif(slsl_lm_plus)
slsl_lm_plus <- lm(dolbomplus ~ students+hanbumo+base+fin+bmi , data = slsl)
vif(slsl_lm_plus)
slsl_lm_plus <- lm(dolbomplus ~ students+hanbumo+fin+bmi , data = slsl)
vif(slsl_lm_plus)
step(slsl_lm_plus.null, scope=list(lower=slsl_lm_plus.null, upper=slsl_lm_plus), direction="both")
summary(slsl_lm_plus)
slsl_lm_plus <- lm(dolbomplus ~ students+fin+bmi , data = slsl)
summary(slsl_lm_plus)
slsl_lm_plus <- lm(dolbomplus ~ students+fin+bmi+hanbumo , data = slsl)
vif(slsl_lm_plus)
summary(slsl_lm_plus)
finance_gu
slsl_lm_plus <- lm(dolbomplus ~ students+bmi+hanbumo , data = slsl)
summary(slsl_lm_plus)
cbind(slsl$gu, slsl$dolbomplus , slsl$fin)
slsl$gu
class(slsl$gu)
cor(slsl$dolbomplus, slsl$fin)
plot(slsl$dolbomplus, slsl$fin)
finance_gu[order(finance_gu$fin),]
head(slsl)
slsl_lm_plus <- lm(dolbom_total ~ students+bmi+hanbumo+fin , data = slsl)
vif(slsl_lm_plus)
summary(slsl_lm_plus)
slsl_lm_plus <- lm(dolbomplus ~ students+bmi+hanbumo+fin , data = slsl)
summary(slsl_lm_plus)
slsl_lm_plus <- lm(dolbomplus ~ students+bmi+hanbumo+fin , data = slsl)
summary(slsl_lm_plus)
slsl_lm_plus <- lm(dolbomplus ~ students+bmi+fin , data = slsl)
summary(slsl_lm_plus)
test_table_01 <- cbind(finance_gu, slsl$dolbomplus)
finance_gu[order(test_table_01$fin),]
test_table_01[order(test_table_01$fin),]
sl_dum.full <- lm(dolbomplus ~ students+hanbumo+fin+bmi, data = slsl)
max(vif(sl_dum.full))
slsl_lm_plus <- lm(dolbomplus ~ students+bmi+fin+hanbumo , data = slsl)
summary(slsl_lm_plus)
slsl_lm_plus <- lm(dolbomplus ~ schoolss+bmi+fin+hanbumo , data = slsl)
slsl_lm_plus <- lm(dolbomplus ~ schools+bmi+fin+hanbumo , data = slsl)
summary(slsl_lm_plus)
test_table_01[order(test_table_01$fin),]
head(slsl)
local$facilities
local
local <- read.table(file.choose(), sep='\t')                  # 자치구별 지역돌봄센터.txt
head(local)
local <- local[5:29,c(2,3,4)]
head(local)
names(local) <- c("gu","facilities","users")
head(local)
local_order <- local[order(local$gu),]
head(local_order)
local_order
local$facilities <- as.numeric(local$facilities)
local$users <- as.numeric(local$users)
class(local$facilities)
local_order
slsl$dolbomplus <- slsl$dolbom_total + local$facilities
slsl$dolbomplus
cor(slsl$dolbomplus, slsl$fin)
plot(slsl$dolbomplus, slsl$fin)
slsl_lm_plus <- lm(dolbomplus ~ schools+bmi+fin+hanbumo , data = slsl)
vif(slsl_lm_plus)
summary(slsl_lm_plus)
slsl_lm_plus <- lm(dolbomplus ~ students+bmi+fin+hanbumo , data = slsl)
vif(slsl_lm_plus)
summary(slsl_lm_plus)
slsl_lm_plus <- lm(dolbomplus ~ students+bmi+fin , data = slsl)
summary(slsl_lm_plus)
slsl$dolbomplus
slsl_lm_plus <- lm(dolbomplus ~ students+bmi+fin+hanbumo , data = slsl)
summary(slsl_lm_plus)
seoulbmi
local_order
local <- local_order
local
slsl$dolbomplus <- slsl$dolbom_total + local$facilities
local$facilities <- as.numeric(local$facilities)
slsl$dolbomplus <- slsl$dolbom_total + local$facilities
head(slsl)
local$facilities
local_order
slsl$dolbomplus <- slsl$dolbom_total + local_order$facilities
local_order$facilities <- as.numeric(local_order$facilities)
local_order
local <- read.table(file.choose(), sep='\t')                  # 자치구별 지역돌봄센터.txt
head(local)
local <- local[5:29,c(2,3,4)]
names(local) <- c("gu","facilities","users")
head(local)
local_order <- local[order(local$gu),]
local_order
local_order$facilities <- as.numeric(local_order$facilities)
local_order
local <- read.table(file.choose(), sep='\t')                  # 자치구별 지역돌봄센터.txt
head(local)
local <- local[5:29,c(2,3,4)]
names(local) <- c("gu","facilities","users")
head(local)
local_order <- local[order(local$gu),]
local_order
as.numeric(local_order$facilities)
as.integer(local_order$facilities)
local_order$facilities
local$facilities
fac <- c(3 , 20, 22 ,19 ,27 ,17 ,21 ,27, 21 ,18 ,13, 23, 11, 8,  7,  11, 27, 19, 24, 15, 5,  27, 12, 5,  25)
fac
class(fac)
cbind(local_order, fac)
local_order <- cbind(local_order, fac)
local_order
class(local$fac)
class(local_order$fac)
slsl$dolbomplus <- slsl$dolbom_total + local_order$fac
slsl$dolbomplus
slsl_lm_plus <- lm(dolbomplus ~ students+bmi+fin+hanbumo , data = slsl)
vif(slsl_lm_plus)
summary(slsl_lm_plus)
slsl_lm_plus <- lm(dolbomplus ~ students+bmi+fin , data = slsl)
summary(slsl_lm_plus)
vif(slsl_lm_plus)
slsl_lm_plus <- lm(dolbomplus ~ students+bmi+fin+hanbumo , data = slsl)
vif(slsl_lm_plus)
step(slsl_lm_plus.null, scope=list(lower=slsl_lm_plus.null, upper=slsl_lm_plus), direction="both")
slsl_lm_plus <- lm(dolbomplus ~ students+bmi+fin, data = slsl)
step(slsl_lm_plus.null, scope=list(lower=slsl_lm_plus.null, upper=slsl_lm_plus), direction="both")
slsl_lm_plus <- lm(dolbomplus ~ students+bmi+fin+hanbumo, data = slsl)
summary(slsl_lm_plus)
step(slsl_lm_plus.null, scope=list(lower=slsl_lm_plus.null, upper=slsl_lm_plus), direction="both")
slsl_lm_plus <- lm(dolbomplus ~ students+bmi+fin, data = slsl)
summary(slsl_lm_plus)
slsl_lm_plus <- lm(dolbomplus ~ students+bmi+hanbumo, data = slsl)
summary(slsl_lm_plus)
#normalization
slsl_norm <- transform(slsl,
z.students = scale(students),
z.hanbumo = scale(hanbumo),
z.bmi = scale(bmi),
z.fin = scale(fin))
head(slsl_norm)
slsl_norm_lm <- lm(dolbomplus ~ z.students+z.hanbumo+z.bmi+z.fin , data = slsl_norm)    # 한부모는 사각지대     ######## finalfinal
summary(slsl_norm_lm)
slsl_norm_lm <- lm(dolbomplus ~ z.students+z.bmi+z.fin , data = slsl_norm)    # 한부모는 사각지대     ######## finalfinal
summary(slsl_norm_lm)
step(slsl_lm_plus.null, scope=list(lower=slsl_lm_plus.null, upper=slsl_lm_plus), direction="forward")
step(slsl_lm_plus.null, scope=list(lower=slsl_lm_plus.null, upper=slsl_lm_plus), direction="backward")
step(slsl_lm_plus.null, scope=list(lower=slsl_lm_plus.null, upper=slsl_lm_plus), direction="both")
local <- read.table(file.choose(), sep='\t')
local <- read.table(file.choose(), sep='\t')
local
local <- read.table(file.choose(), sep='\t', header = T)           # (2018)광역시별_지역아동센터현황.txt
local
local[3:18,]
local <- local[3:18,]
names(local) <- c("region","facilities","users")
head(local)
finance <- read.table(file.choose(), sep='\t', header = T)
finance
finance[2:17,c(1,4)]
finance_20 <- finance[2:17,c(1,4)]
fin_20 <- finance[2:17,c(1,4)]
names(fin_20) <- c("region","fin")
fin_20
cbind(fin_20$region, local$region)
cbind(fin_20, local)
bmi <- read.table(file.choose(), sep='\t', header = T)
bmi
names(bmi) <- c("region","bmi")
bmi
local_2020 <- read.table(file.choose(), sep='\t', header = T)           # (2020)광역시별_지역아동센터현황.txt
local_2020
local_2020 <- local[1:18,]
local_2020
local_2020 <- read.table(file.choose(), sep='\t', header = T)           # (2020)광역시별_지역아동센터현황.txt
local_2020 <- local_2020[1:18,]
local_2020
local_20fac <- local_2020[3:18,1:2]
local_20fac
names(local_20fac) <- c("region","facilities")
local_20fac
class(local_20fac$facilities)
fin_20
dolbom <- read.table(file.choose(), sep='\t')       # 전국돌봄교실.txt
dolbom <- read.table(file.choose(), sep='\t')       # 전국돌봄교실.txt
dolbom
names(dolbom) <- c("region","dolbom")
dolbom
whole <- cbind(dolbom, local_20fac$facilities, fin_20$fin, bmi$bmi)
whole
students <- read.table(file.choose(), sep='\t', header = T)         #
students
whole$dolbomplus <- dolbom$dolbom + local_20fac$facilities
whole
whole <- cbind(whole, students$students)
students
students <- students[3:18,]
whole <- cbind(whole, students$students)
whole
whole_draft <- whole[,c(1,6,7,4,5)]
whole_draft
names(whole_draft) <- c("region","dolbomplus","students","fin","bmi")
whole_draft
whole_dr_sj <- whole_draft[-7,]
whole_dr_sj
local <- read.table(file.choose(), sep='\t')                  # 자치구별 지역돌봄센터.txt
head(local)
local <- local[5:29,c(2,3,4)]
names(local) <- c("gu","facilities","users")
head(local)
local$facilities
local_order <- local[order(local$gu),]
local_order
fac <- c(3 , 20, 22 ,19 ,27 ,17 ,21 ,27, 21 ,18 ,13, 23, 11, 8,  7,  11, 27, 19, 24, 15, 5,  27, 12, 5,  25)
class(fac)
local_order <- cbind(local_order, fac)
local_order$facilities <- as.integer(local_order$facilities)
local_order
finance <- read.table(file.choose(), sep='\t', header=T)        # 자치구별 재정자립도.txt
finance
finance_gu <- finance[4:28,2:3]
finance_gu <- finance_gu[order(finance_gu$자치구별),]
finance_gu
seoulbmi <- read.table(file.choose(), sep='\t', header=T)
seoulbmi <- read.table(file.choose(), sep='\t', header=T)    # 서울 구별 비만지수(초5,초6).txt
seoulbmi
class(seoulbmi$bmi)
slsl <- read.table(file.choose(), sep='\t', header=T)       # slsl.txt
local
slsl$dolbomplus <- slsl$dolbom_total + local_order$fac
slsl <- cbind(slsl, finance_gu$fin, seoulbmi$bmi)
slsl
slsl <- cbind(slsl, finance_gu$fin, seoulbmi$bmi)
finance_gu$fin
names(finance_gu) <- c("gu", "fin")
finance_gu$fin
slsl <- cbind(slsl, finance_gu$fin, seoulbmi$bmi)
slsl
head(slsl)
colnames(slsl) <- c("gu","schools","students","dolbom_avg","students_par_per", "hanbumo","base",
"dolbom_total","dolbomplus","fin","bmi")
class(slsl$students)
slsl$students
#regression
slsl_lm_plus.null <- lm(dolbomplus~1, data = slsl)
slsl_lm_plus <- lm(dolbomplus ~ students+bmi+fin, data = slsl)
vif(slsl_lm_plus)
library(car)
vif(slsl_lm_plus)
step(slsl_lm_plus.null, scope=list(lower=slsl_lm_plus.null, upper=slsl_lm_plus), direction="both")
summary(slsl_lm_plus)
predict(slsl_lm_plus)
?predict
whole_dr_sj$pred <- -6.997e+02 + 4.144e-03 * whole_dr_sj$students + 3.698e+01 * whole_dr_sj$bmi + (-4.292e-01) * whole_dr_sj$fin
whole_dr_sj
whole_dr_sj$diff <- whole_dr_sj$pred - whole_dr_sj$dolbomplus
whole_dr_sj
bmi
bmi[7,2]
bmi[7,2] <- 19.73617021
bmi
whole_draft
whole_draft$bmi <- bmi$bmi
whole_draft$bmi
whole_draft
whole_draft$pred <- -6.997e+02 + 4.144e-03 * whole_draft$students +
3.698e+01 * whole_draft$bmi + (-4.292e-01) * whole_draft$fin
whole_draft
whole_draft$diff <- whole_draft$pred - whole_draft$dolbomplus
whole_draft
library(olsrr)
ols_plot_resid_stud(slsl_lm)
ols_plot_resid_stud(slsl_lm_plus)
ols_plot_resid_lev(slsl_lm_plus)
# deleting outliers, leverages
slsl[c(-2, 14, 17, 25),]
# deleting outliers, leverages
slsl[c(-2, -14, -17, -25),]
# deleting outliers, leverages
slsl_wo <- slsl[c(-2, -14, -17, -25),]
slsl_wo_lm_plus.null <- lm(dolbomplus~1, data = slsl_wo)
slsl_wo_lm_plus <- lm(dolbomplus ~ students+bmi+fin, data = slsl_wo)
vif(slsl_wo_lm_plus)
step(slsl_wo_lm_plus.null, scope=list(lower=slsl_wo_lm_plus.null, upper=slsl_wo_lm_plus), direction="both")
summary(slsl_wo_lm_plus)
slsl_wo_lm_plus <- lm(dolbomplus ~ students+bmi+fin+hanbumo, data = slsl_wo)
vif(slsl_wo_lm_plus)
summary(slsl_wo_lm_plus)
slsl_wo_lm_plus <- lm(dolbomplus ~ students+bmi+hanbumo, data = slsl_wo)
summary(slsl_wo_lm_plus)
summary(slsl_wo_lm_plus)
summary(slsl_lm_plus)
slsl
slsl[,c("gu","dolbomplus","students",
"fin","bmi")]
library(writexl)
write_xlsx(sl_elmnt, path = 'C:/Users/i/Desktop/slsl_checking.xlsx')
slsl_checking <- slsl[,c("gu","dolbomplus","students",
"fin","bmi")]
write_xlsx(slsl_checking, path = 'C:/Users/i/Desktop/slsl_checking.xlsx')
slsl_checking <- slsl[,c("gu","dolbomplus","students",
"fin","bmi")]
library(writexl)
write_xlsx(slsl_checking, path = 'C:/Users/i/Desktop/slsl_checking.xlsx')
class(slsl_checking)
write_xlsx(slsl_checking, path = 'C:/Users/kimje/Desktop/slsl_checking.xlsx')
# deleting outliers, leverages
slsl_wo <- slsl[c(-2, -14, -17),]
slsl_wo_lm_plus.null <- lm(dolbomplus~1, data = slsl_wo)
slsl_wo_lm_plus <- lm(dolbomplus ~ students+bmi+hanbumo, data = slsl_wo)
summary(slsl_wo_lm_plus)
slsl_wo_lm_plus <- lm(dolbomplus ~ students+bmi+fin, data = slsl_wo)
slsl_wo
slsl_wo_lm_plus <- lm(dolbomplus ~ students+bmi+fin, data = slsl_wo)
summary(slsl_wo_lm_plus)
slsl_wo_lm_plus <- lm(dolbomplus ~ students+bmi+fin+hanbumo, data = slsl_wo)
summary(slsl_wo_lm_plus)
step(slsl_wo_lm_plus.null, scope=list(lower=slsl_wo_lm_plus.null, upper=slsl_wo_lm_plus), direction="both")
slsl_wo_lm_plus <- lm(dolbomplus ~ students+bmi+hanbumo, data = slsl_wo)
summary(slsl_wo_lm_plus)
step(slsl_wo_lm_plus.null, scope=list(lower=slsl_wo_lm_plus.null, upper=slsl_wo_lm_plus), direction="both")
slsl_wo_lm_plus <- lm(dolbomplus ~ students+bmi+fin, data = slsl_wo)
summary(slsl_wo_lm_plus)
slsl_wo_lm_plus <- lm(dolbomplus ~ students+bmi+fin+hanbumo, data = slsl_wo)
vif(slsl_wo_lm_plus)
slsl_wo_lm_plus <- lm(dolbomplus ~ students+bmi+fin, data = slsl_wo)
vif(slsl_wo_lm_plus)
# boxplot
boxplot(slsl$students)
boxplot(slsl$fin)
boxplot(slsl$bmi)
# deleting outliers, leverages
slsl_wo <- slsl[c(-25),]
slsl_wo_lm_plus.null <- lm(dolbomplus~1, data = slsl_wo)
slsl_wo_lm_plus <- lm(dolbomplus ~ students+bmi+fin, data = slsl_wo)
vif(slsl_wo_lm_plus)
step(slsl_wo_lm_plus.null, scope=list(lower=slsl_wo_lm_plus.null, upper=slsl_wo_lm_plus), direction="both")
summary(slsl_wo_lm_plus)
#normalization
slsl_norm <- transform(slsl,
z.students = scale(students),
z.hanbumo = scale(hanbumo),
z.bmi = scale(bmi),
z.fin = scale(fin))
head(slsl_norm)
#normalization
slsl_norm <- transform(slsl,
z.dolbomplus = scale(dolbomplus),
z.students = scale(students),
z.hanbumo = scale(hanbumo),
z.bmi = scale(bmi),
z.fin = scale(fin))
head(slsl_norm)
slsl_norm[,c("gu","dolbomplus","students","fin","bmi","z.dolbomplus","z.students","z.bmi","z.fin")]
slsl_norm_checking <- slsl_norm[,c("gu","dolbomplus","students","fin","bmi","z.dolbomplus","z.students","z.bmi","z.fin")]
write_xlsx(slsl_norm_checking, path = 'C:/Users/kimje/Desktop/slsl_normal_checking.xlsx')
slsl_lm_plus <- lm(dolbomplus ~ students+bmi+fin, data = slsl)
predict(slsl_lm_plus)
ols_plot_resid_stud(slsl_lm_plus)
ols_plot_resid_lev(slsl_lm_plus)            # checking outliers, leverages
# deleting outliers, leverages
slsl_wo <- slsl[c(-2,-14,-17),]
slsl_wo_lm_plus.null <- lm(dolbomplus~1, data = slsl_wo)
slsl_wo_lm_plus <- lm(dolbomplus ~ students+bmi+fin, data = slsl_wo)
vif(slsl_wo_lm_plus)
summary(slsl_wo_lm_plus)
whole_draft$pred <- dolbomplus = -7.804e+02 + 4.160e-03 * whole_draft$students +
4.125e+01 * whole_draft$bmi + (-5.234e-01) * whole_draft$fin
whole_draft$pred <- -7.804e+02 + 4.160e-03 * whole_draft$students +
4.125e+01 * whole_draft$bmi + (-5.234e-01) * whole_draft$fin
whole_draft$diff <- whole_draft$pred - whole_draft$dolbomplus
whole_draft
medi <- read.table(file.choose(), sep='\t', header=T)       # slsl.txt
slsl <- read.table(file.choose(), sep='\t')       # slsl.txt
medi
medi <- read.table(file.choose(), sep='\t', header=T)       # 서울시 의료기관종사 의료인력 (구별) 통계 2018.txt
medi <- read.table(file.choose(), sep='\t', header=T)       # 서울시 의료기관종사 의료인력 (구별) 통계 2018.txt
medi
medi[2:26,c(2,4,9)]
medi <- medi[2:26,c(2,4,9)]
medi$doctt <- medi$의사 + medi$간호사
slsl <- read.table(file.choose(), sep='\t')       # slsl.txt
medi
class(medi$의사)
medi$의사 <- as.integer(medi$의사)
medi$의사
medi <- read.table(file.choose(), sep='\t', header=T)       # 서울시 의료기관종사 의료인력 (구별) 통계 2018.txt
medi
medi <- medi[2:26,c(2,4,9)]
medi
medi <- read.table(file.choose(), sep='\t', header=T)       # 서울시 의료기관종사 의료인력 (구별) 통계 2018.txt
medi
medi[2:26,c(2,4,9)]
medi[2:26,c(2,4,9,10)]
medi <- medi[2:26,c(2,4,9,10)]
class(medi$의사)
medi$doctt <- medi$의사 + medi$간호사 + medi$간호조무사
slsl <- read.table(file.choose(), sep='\t')       # slsl.txt
medi
#slsl <- cbind(slsl, smoke$smoper, smoke$sm, alcohol$alper, alcohol$al)
slsl <- cbind(slsl, medi$doctt)
head(slsl)
colnames(slsl) <- c("gu","schools","students","dolbom_avg","students_par_per", "hanbumo","base",
"dolbom_total","dolbomplus","fin","bmi", "medi")
head(slsl)
slsl_lm_plus <- lm(dolbomplus ~ students+bmi+fin+medi, data = slsl)
#regression
slsl_lm_plus.null <- lm(dolbomplus~1, data = slsl)
vif(slsl_lm_plus)
step(slsl_lm_plus.null, scope=list(lower=slsl_lm_plus.null, upper=slsl_lm_plus), direction="both")
summary(slsl_lm_plus)
slsl_lm_plus <- lm(dolbomplus ~ students+bmi+fin, data = slsl)
summary(slsl_lm_plus)
slsl_lm_plus <- lm(dolbomplus ~ students+bmi+fin+medi, data = slsl)
summary(slsl_lm_plus)
step(slsl_lm_plus.null, scope=list(lower=slsl_lm_plus.null, upper=slsl_lm_plus), direction="both")
